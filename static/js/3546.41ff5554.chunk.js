(self.webpackChunk_uniswap_interface=self.webpackChunk_uniswap_interface||[]).push([[3546],{97526:(e,t,i)=>{var r=i(4638);t.c=function(e){var t=e.params,i=(0,n.default)(e,u),r=[l.ReactQueryCacheKey.TradingApi,a.uniswapUrls.tradingApiPaths.migrate,t];return(0,s.useQuery)(Object.assign({queryKey:r,queryFn:function(){var e=(0,o.default)((function*(){if(!t)throw{name:"Params are required"};return yield(0,c.migrateLpPosition)(t)}));return function(){return e.apply(this,arguments)}}()},i))};var o=r(i(79283)),n=r(i(70692)),s=i(78225),a=i(68016),c=i(72310),l=i(3009),u=["params"]},16153:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});const r={}},40330:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});const r={}},97032:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});const r={}},56178:(e,t,i)=>{"use strict";i.d(t,{m:()=>s});var r=i(63462),o=i(41818),n=i(41186);function s(e){return(0,r.a)(o.bt,e,{transport:n.uniswapGetTransport,enabled:!!e})}},88906:(e,t,i)=>{"use strict";i.d(t,{w:()=>_});var r=i(97755),o=i(20128),n=i(82663),s=i(19275),a=i(90887),c=i(59793),l=i(85193),u=i(36847),d=i(1305),p=i(68127);const x="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _position-absolute _top-0 _right-0 _pt-t-space-spa94665589 _pr-t-space-spa94665589 _pb-t-space-spa94665589 _pl-t-space-spa94665589 ",m="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _justifyContent-space-betwe3241 _alignItems-center _gap-t-space-spa94665589 _width-10037 ";function _({title:e,closeModal:t,goBack:i}){const{t:_}=(0,n.useTranslation)(),v=(0,o.useMemo)((()=>(0,r.jsx)(s.ModalCloseIcon,{testId:"LiquidityModalHeader-close",onClose:t})),[t]);return(0,r.jsxs)("div",{className:m,children:[i?(0,r.jsx)(a.Z,{onPress:i,children:(0,r.jsx)(l.BackArrow,{color:"$neutral1",size:"$icon.24"})}):v,(0,r.jsx)(c.Text,{variant:"body2",flexGrow:1,textAlign:"center",pr:24,children:e}),i?(0,r.jsx)("div",{className:x,children:v}):(0,r.jsx)(u.SwapFormSettings,{adjustTopAlignment:!1,settings:[p.Slippage,d.o],defaultTitle:_("pool.positions.transaction.settings")})]})}i(97032)},24476:(e,t,i)=>{"use strict";i.d(t,{s:()=>m});var r=i(97755),o=i(16467),n=i(88963),s=i(10795),a=i(59793),c=i(63691),l=i(81886),u=i(90327),d=i(61463);const p="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _flexGrow-1 ",x="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _alignItems-center ";function m({currencyAmount:e,currencyUSDAmount:t,isMigrating:i=!1}){var m,_,v;const{formatCurrencyAmount:g}=(0,l.useLocalizationContext)(),f=i?(0,s.Ct)(null===(m=e)||void 0===m?void 0:m.currency,o.Qe.V4):null===(_=e)||void 0===_?void 0:_.currency;return(0,r.jsxs)("div",{className:x,children:[(0,r.jsxs)("div",{className:p,children:[(0,r.jsxs)(a.Text,{variant:"heading2",children:[g({value:e,type:d.NumberType.TokenNonTx})," ",(0,u.getSymbolDisplayText)(null===(v=f)||void 0===v?void 0:v.symbol)]}),(0,r.jsx)(a.Text,{variant:"body3",color:"$neutral2",children:g({value:t,type:d.NumberType.FiatStandard})})]}),(0,r.jsx)(n.Z,{currency:f,size:c._.icon36})]})}i(40330)},65294:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>we});var r=i(97755),o=i(16467),n=i(16551),s=i(19087),a=i(88906),c=i(88602),l=i(24476),u=i(28912),d=i(48426),p=i(92948),x=i(92452),m=i(71484),_=i(85752),v=i(52435),g=i(59553),f=i(96677),y=i(10795),h=i(20128),b=i(27281),T=i(97526),S=i(22323),k=i(46433),I=i(66789),j=i(88495),C=i(58146),A=i(96881),P=i(87058),w=i(93312),N=i(46832),R=i(13052),E=i(56156);const q=(0,h.createContext)(void 0);function M({children:e,positionInfo:t}){var i,n,s,a,c;const l=(0,E.m)(),[u,d]=(0,h.useState)(!1),{derivedPositionInfo:p,positionState:x,currentTransactionStep:m}=(0,f.kU)(),{feeValue0:M,feeValue1:V}=(0,v.rZ)(t),{derivedPriceRangeInfo:D,priceRangeState:{fullRange:L}}=(0,f.$s)(),O=(0,h.useMemo)((()=>{if(t&&l.address)return{simulateTransaction:!0,walletAddress:l.address,chainId:t.currency0Amount.currency.chainId,protocol:S.ProtocolItems.V3,positionToken:t.tokenId}}),[t,l.address]),{data:B,isLoading:z,error:U,refetch:$}=(0,b.F)({params:O,headers:{"x-universal-router-version":S.UniversalRouterVersion._2_0},staleTime:5*R.ONE_SECOND_MS,enabled:Boolean(O)});if(U){const e=(0,C.parseErrorMessageTitle)(U,{defaultTitle:"unknown CheckLpApprovalQuery"});N.logger.error(e,{tags:{file:"MigrateV3LiquidityTxContext",function:"useEffect"}})}const F=!z&&Boolean(null===(i=B)||void 0===i?void 0:i.permitData),Q=(0,h.useMemo)((()=>{var e,i,r,n,s,a,c,u;if(!p||!t||!t.tokenId||!(null===(e=l)||void 0===e?void 0:e.address)||!D||p.protocolVersion!==o.Qe.V4||D.protocolVersion!==o.Qe.V4||!t.pool||!t.liquidity)return;const d=p.pool??D.mockPool;if(!d)return;const m=L?D.tickSpaceLimits[0]:null===(i=D.ticks)||void 0===i?void 0:i[0],_=L?D.tickSpaceLimits[1]:null===(r=D.ticks)||void 0===r?void 0:r[1];return void 0!==m&&void 0!==_&&t.pool&&t.liquidity?{simulateTransaction:!F,inputProtocol:S.ProtocolItems.V3,tokenId:Number(t.tokenId),inputPosition:{pool:{token0:t.currency0Amount.currency.isNative?g.r_:t.currency0Amount.currency.address,token1:t.currency1Amount.currency.isNative?g.r_:t.currency1Amount.currency.address,fee:t.feeTier?Number(t.feeTier):void 0,tickSpacing:(null===(n=t)||void 0===n?void 0:n.tickSpacing)?Number(null===(s=t)||void 0===s?void 0:s.tickSpacing):void 0},tickLower:t.tickLower?Number(t.tickLower):void 0,tickUpper:t.tickUpper?Number(t.tickUpper):void 0},inputPoolLiquidity:t.pool.liquidity.toString(),inputCurrentTick:t.pool.tickCurrent,inputSqrtRatioX96:null===(a=t.pool.sqrtRatioX96)||void 0===a?void 0:a.toString(),inputPositionLiquidity:t.liquidity,outputProtocol:S.ProtocolItems.V4,outputPosition:{pool:{token0:(0,y.d2)(d.currency0),token1:(0,y.d2)(d.currency1),fee:x.fee.feeAmount,hooks:x.hook,tickSpacing:d.tickSpacing},tickLower:m,tickUpper:_},outputPoolLiquidity:p.creatingPoolOrPair?void 0:d.liquidity.toString(),outputSqrtRatioX96:p.creatingPoolOrPair?void 0:d.sqrtRatioX96.toString(),outputCurrentTick:p.creatingPoolOrPair?void 0:d.tickCurrent,initialPrice:p.creatingPoolOrPair?d.sqrtRatioX96.toString():void 0,chainId:t.currency0Amount.currency.chainId,walletAddress:l.address,expectedTokenOwed0RawAmount:(null===(c=M)||void 0===c?void 0:c.quotient.toString())??"0",expectedTokenOwed1RawAmount:(null===(u=V)||void 0===u?void 0:u.quotient.toString())??"0",amount0:t.currency0Amount.quotient.toString(),amount1:t.currency1Amount.quotient.toString()}:void 0}),[p,t,l,D,L,x.fee.feeAmount,x.hook,null===(n=M)||void 0===n?void 0:n.quotient,null===(s=V)||void 0===s?void 0:s.quotient,F]),W=D.protocolVersion!==o.Qe.V2&&!D.invalidPrice&&!D.invalidRange,H=!((null===(a=m)||void 0===a?void 0:a.step.type)===A.TransactionStepType.MigratePositionTransaction||(null===(c=m)||void 0===c?void 0:c.step.type)===A.TransactionStepType.MigratePositionTransactionAsync)&&!z&&!U&&Boolean(Q)&&W,{data:K,error:G,refetch:Z}=(0,T.c)({params:Q,refetchInterval:!u&&5*R.ONE_SECOND_MS,retry:!1,enabled:H});if((0,h.useEffect)((()=>{d(!!G)}),[G,Q]),G){const e=(0,C.parseErrorMessageTitle)(G,{defaultTitle:"unknown MigrateLpPositionCalldataQuery"});N.logger.error(e,{tags:{file:"MigrateV3LiquidityTxContext",function:"useEffect"}}),(0,I.sendAnalyticsEvent)(k.InterfaceEventNameLocal.MigrateLiquidityFailed,{message:e})}const X=(0,h.useMemo)((()=>{var e,i,r;if(!K)return;const n=(0,w.validatePermit)(null===(e=B)||void 0===e?void 0:e.permitData);if((null===(i=B)||void 0===i?void 0:i.permitData)&&!n)return;const s=(0,w.validateTransactionRequest)(K.migrate);if(!s)return;const a=_.CurrencyAmount.fromRawAmount((0,y.Ct)(t.currency0Amount.currency,o.Qe.V4),t.currency0Amount.quotient),c=_.CurrencyAmount.fromRawAmount((0,y.Ct)(t.currency1Amount.currency,o.Qe.V4),t.currency1Amount.quotient);return{type:j.LiquidityTransactionType.Migrate,unsigned:Boolean(null===(r=B)||void 0===r?void 0:r.permitData),migratePositionRequestArgs:Q,approveToken0Request:void 0,approveToken1Request:void 0,permit:n?{method:P.PermitMethod.TypedData,typedData:n}:void 0,protocolVersion:o.Qe.V3,approvePositionTokenRequest:void 0,revokeToken0Request:void 0,revokeToken1Request:void 0,token0PermitTransaction:void 0,token1PermitTransaction:void 0,txRequest:s,action:{type:j.LiquidityTransactionType.Migrate,currency0Amount:a,currency1Amount:c}}}),[K,Q,B,t.currency0Amount,t.currency1Amount]);return(0,r.jsx)(q.Provider,{value:{txInfo:X,error:(0,C.getErrorMessageToDisplay)({approvalError:U,calldataError:G}),refetch:U?$:G?Z:void 0},children:e})}var V=i(23389);var D=i(76557),L=i(40384),O=i(43965),B=i(97973),z=i(62019),U=i(96161),$=i(25802),F=i(38382),Q=i(58426),W=i(82663),H=i(24928),K=i(63933),G=i(11516),Z=i(62504),X=i(49476),Y=i(57154),J=i(74456),ee=i(11884),te=i(60759),ie=i(59793),re=i(82746),oe=i(19437),ne=i(32292),se=i(42117),ae=i(64955),ce=i(95336),le=i(39770),ue=i(56178),de=i(8729),pe=i(27754),xe=i(4545),me=i(70850),_e=i(63797),ve=i(23907),ge=i(34786),fe=i(70943),ye=i(31230);const he="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _gap-t-space-gap1573 _pr-t-space-pad1331704925 _pl-t-space-pad1331704925 _mt-t-space-spa94665593 _mb-t-space-spa94665593 ",be="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _mb-t-space-spa1360334051 ",Te="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-1 _flexDirection-column _backgroundColor-surface2 _borderTopLeftRadius-t-radius-ro291586453 _borderTopRightRadius-t-radius-ro291586453 _borderBottomRightRadius-t-radius-ro291586453 _borderBottomLeftRadius-t-radius-ro291586453 _pt-t-space-pad1331704929 _pr-t-space-pad1331704929 _pb-t-space-pad1331704929 _pl-t-space-pad1331704929 ",Se="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _justifyContent-center _alignItems-center ",ke="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _gap-t-space-gap1573 _maxWidth-calcmin580p890974940 ",Ie="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _gap-32px _width-10037 ",je="  _display-flex _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-row _justifyContent-space-betwe3241 _alignItems-center _gap-t-space-gap1598 _width-10037 ",Ce="  _display-flex _alignItems-stretch _flexBasis-auto _boxSizing-border-box _position-relative _minHeight-0px _minWidth-0px _flexShrink-0 _flexDirection-column _mt-t-space-spa1360333981 _gap-t-space-gap1635 ",Ae=(0,J.z)(ee.or,{backgroundColor:"$surface1",display:"flex",flexDirection:"row",gap:60,mt:"1rem",mx:"auto",width:"100%",zIndex:"$default",p:24});function Pe({positionInfo:e}){var t;const{chainName:i,tokenId:d}=(0,K.UO)(),p=(0,fe.useTrace)(),{t:_}=(0,W.useTranslation)(),{positionState:v,setPositionState:g,setStep:b,step:T,currentTransactionStep:S,setCurrentTransactionStep:I}=(0,f.kU)(),{protocolVersion:C}=v,{setPriceRangeState:A}=(0,f.$s)(),{setDepositState:P}=(0,f.EY)(),[w,N]=(0,h.useState)([]),R=(0,m.Z)(),M=(0,E.m)().chainId,V=(0,le.useAccountMeta)(),D=(0,H.useDispatch)(),{txInfo:z,error:F,refetch:G}=function(){const e=(0,h.useContext)(q);if(!e)throw new Error("useMigrateV3TxContext must be used within a MigrateV3PositionTxContextProvider");return e}(),J=(0,te.GS)(),ee=(0,K.s0)(),ue=()=>{I(void 0)},{currency0Amount:pe,currency1Amount:me,owner:_e}=e,ve=(0,xe.useUSDCValue)(pe)??void 0,ye=(0,xe.useUSDCValue)(me)??void 0;return(0,ge.isSameAddress)(null===(t=V)||void 0===t?void 0:t.address,_e)||ee("/positions"),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:Ce,children:[(0,r.jsxs)(n.zG,{"aria-label":"breadcrumb-nav",children:[(0,r.jsxs)(n.yY,{to:"/positions",children:[(0,r.jsx)(W.Trans,{i18nKey:"pool.positions.title"})," ",(0,r.jsx)(Q.Z,{size:14})]}),(0,r.jsxs)(n.yY,{to:`/positions/v3/${i}/${d}`,children:[pe.currency.symbol," / ",me.currency.symbol," ",(0,r.jsx)(Q.Z,{size:14})]})]}),(0,r.jsxs)("div",{className:je,children:[(0,r.jsx)(ie.Text,{width:"100%",variant:"heading2",children:(0,r.jsx)(W.Trans,{i18nKey:"common.migrate.position"})}),(0,r.jsxs)(re.Flex,{row:!0,backgroundColor:"$surface2",borderRadius:"$rounded12",alignItems:"center",justifyContent:"center",gap:"$gap4",py:"$padding8",px:"$padding12",...X.G,onPress:()=>{g({...$.vF,protocolVersion:C,currencyInputs:{[Y.R.TOKEN0]:(0,y.Ct)(pe.currency,C),[Y.R.TOKEN1]:(0,y.Ct)(me.currency,C)}}),A(f.be),P(f.gr),b($.bC.SELECT_TOKENS_AND_FEE_TIER)},children:[(0,r.jsx)(ne.C,{color:"$neutral1",size:16}),(0,r.jsxs)(ie.Text,{variant:"buttonLabel4",color:"$neutral2",children:[(0,r.jsx)(W.Trans,{i18nKey:"common.button.reset"})," xxx"]})]})]}),(0,r.jsxs)("div",{className:Ie,children:[!J.xl&&(0,r.jsx)(re.Flex,{width:360,alignSelf:"flex-start","$platform-web":{position:"sticky",top:se.d+25},children:(0,r.jsx)(x.y,{steps:[{label:_("migrate.selectFeeTier"),active:T===$.bC.SELECT_TOKENS_AND_FEE_TIER},{label:_("migrate.setRange"),active:T===$.bC.PRICE_RANGE}]})}),(0,r.jsxs)("div",{className:ke,children:[(0,r.jsx)(c.T,{liquidityPosition:e,disabled:!0}),(0,r.jsx)("div",{className:Se,children:(0,r.jsx)("div",{className:Te,children:(0,r.jsx)(oe.ArrowDown,{size:20,color:"$neutral1"})})}),T===$.bC.SELECT_TOKENS_AND_FEE_TIER?(0,r.jsx)(B.H,{width:"100%",maxWidth:"unset",tokensLocked:!0,onContinue:()=>{b($.bC.PRICE_RANGE)}}):(0,r.jsx)(L.o,{width:"100%",maxWidth:"unset"}),T===$.bC.PRICE_RANGE&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.W2,{width:"100%",maxWidth:"unset",children:(0,r.jsx)(O.u,{positionInfo:e,onDisableContinue:!z||Boolean(F),onContinue:()=>{var t;const i=(0,j.isValidLiquidityTxContext)(z);V&&(null===(t=V)||void 0===t?void 0:t.type)===de.AccountType.SignerMnemonic&&i&&D(Z.h.actions.trigger({selectChain:R,startChainId:M,account:V,liquidityTxContext:z,setCurrentStep:I,setSteps:N,onSuccess:()=>{ue(),ee("/positions")},onFailure:ue,analytics:{...(0,u.l)({trace:p,fee:e.feeTier,currency0:pe.currency,currency1:me.currency,currency0AmountUsd:ve,currency1AmountUsd:ye,poolId:e.poolId,version:o.Qe.V3}),action:"V3->V4"}}))}})}),(0,r.jsx)("div",{className:be,children:(0,r.jsx)(s.p,{errorMessage:F,onPress:G})})]})]})]})]}),(0,r.jsxs)(ce.Modal,{name:k.ModalName.MigrateLiquidity,onClose:ue,isDismissible:!0,isModalOpen:Boolean(S),children:[(0,r.jsx)(a.w,{title:_("pool.migrateLiquidity"),closeModal:ue}),(0,r.jsxs)("div",{className:he,children:[(0,r.jsx)(l.s,{currencyAmount:pe,currencyUSDAmount:ve,isMigrating:!0}),(0,r.jsx)(ie.Text,{variant:"body3",color:"$neutral2",children:_("common.and")}),(0,r.jsx)(l.s,{currencyAmount:me,currencyUSDAmount:ye,isMigrating:!0})]}),(0,r.jsx)(ae.ProgressIndicator,{steps:w,currentStep:S})]})]})}function we(){var e;const{tokenId:t}=(0,K.UO)(),i=(0,ye._4)(),n=(0,E.m)(),s=(0,z.F)(o.Qe.V3),{data:a,isLoading:c}=(0,ue.m)(n.address?{owner:n.address,protocolVersion:o.Qe.V3,tokenId:t,chainId:i??n.chainId}:void 0),l=null===(e=a)||void 0===e?void 0:e.position,u=(0,h.useMemo)((()=>(0,d.tS)(l)),[l]),x=function(e){return(0,h.useMemo)((()=>{if(!e)return;if(e.status!==o.H6.OUT_OF_RANGE)return;if(e.version!==o.Qe.V3)return;if(!e.pool)return;const t=Number(e.tickLower),i=Number(e.tickUpper),r=(0,V.B)(e.pool.token1).isNative;return{tickLower:r?-i:t,tickUpper:r?-t:i,isOutOfRange:e.status===o.H6.OUT_OF_RANGE}}),[e])}(u);if(c||!l||!u||u.version!==o.Qe.V3)return(0,r.jsx)(Ae,{children:(0,r.jsxs)(p.pr,{children:[(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{}),(0,r.jsx)(F.PI,{})]})});const{currency0Amount:m,currency1Amount:_,feeTier:v}=u;return(0,r.jsx)(pe.default,{logImpression:!0,page:k.InterfacePageNameLocal.MigrateV3,properties:{pool_address:u.poolId,chain_id:i??n.chainId,label:[m.currency.symbol,_.currency.symbol].join("/"),fee_tier:v,token0Address:(0,ve.currencyIdToAddress)((0,ve.currencyId)(m.currency)),token1Address:(0,ve.currencyIdToAddress)((0,ve.currencyId)(_.currency))},children:(0,r.jsx)(G.f,{initialChainId:i,children:(0,r.jsx)(me.TransactionSettingsContextProvider,{settingKey:_e.TransactionSettingKey.LP,autoSlippageTolerance:s,children:(0,r.jsx)(D.gv,{initialState:{initialPosition:x,currencyInputs:{[Y.R.TOKEN0]:(0,y.Ct)(m.currency,o.Qe.V4),[Y.R.TOKEN1]:(0,y.Ct)(_.currency,o.Qe.V4)}},children:(0,r.jsx)(D.g_,{children:(0,r.jsx)(D.MJ,{children:(0,r.jsx)(M,{positionInfo:u,children:(0,r.jsx)(Pe,{positionInfo:u})})})})})})})})}i(16153)},23389:(e,t,i)=>{"use strict";i.d(t,{B:()=>o});var r=i(21020);function o(e){var t;return e.isNative?e:(null===(t=r.WRAPPED_NATIVE_CURRENCY[e.chainId])||void 0===t?void 0:t.equals(e))?(0,r.nativeOnChain)(e.chainId):e}}}]);
//# sourceMappingURL=3546.41ff5554.chunk.js.map